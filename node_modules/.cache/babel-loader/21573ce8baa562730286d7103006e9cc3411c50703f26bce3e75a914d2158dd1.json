{"ast":null,"code":"import React,{useState,useEffect,useMemo}from'react';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function parseTime(str){const[h,m]=str.split(':').map(Number);return h*60+m;}function formatCountdown(mins){if(mins<=0)return'now';const h=Math.floor(mins/60);const m=mins%60;return h?\"\".concat(h,\"h \").concat(m,\"m\"):\"\".concat(m,\"m\");}export default function CampusBus(_ref){var _data$categories,_data$categories$cat;let{data}=_ref;const categories=Object.keys((data===null||data===void 0?void 0:data.categories)||{});const[cat,setCat]=useState(categories[0]||'');const[direction,setDirection]=useState('toCampus');const[hidePast,setHidePast]=useState(true);const[now,setNow]=useState(()=>new Date());useEffect(()=>{const id=setInterval(()=>setNow(new Date()),60*1000);return()=>clearInterval(id);},[]);useEffect(()=>{if(!categories.includes(cat)&&categories[0])setCat(categories[0]);},[categories,cat]);const minutesNow=now.getHours()*60+now.getMinutes();const times=(data===null||data===void 0?void 0:(_data$categories=data.categories)===null||_data$categories===void 0?void 0:(_data$categories$cat=_data$categories[cat])===null||_data$categories$cat===void 0?void 0:_data$categories$cat[direction])||[];const futureTimes=times.filter(t=>!hidePast||parseTime(t)>=minutesNow);const nextTime=times.find(t=>parseTime(t)>=minutesNow);const countdown=nextTime?formatCountdown(parseTime(nextTime)-minutesNow):null;const specials=(data===null||data===void 0?void 0:data.specials)||[];const specialList=useMemo(()=>specials.slice().sort((a,b)=>parseTime(a.time)-parseTime(b.time)),[specials]);if(!categories.length)return/*#__PURE__*/_jsx(\"div\",{className:\"panel\",children:/*#__PURE__*/_jsx(\"p\",{children:\"No bus data.\"})});return/*#__PURE__*/_jsxs(\"div\",{className:\"panel\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"panel-header\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Campus Buses\"}),/*#__PURE__*/_jsx(\"div\",{className:\"segmented-inline\",children:categories.map(c=>/*#__PURE__*/_jsx(\"button\",{className:c===cat?'active':'',onClick:()=>setCat(c),children:c},c))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"segmented-inline\",children:[['toCampus','fromCampus'].map(d=>/*#__PURE__*/_jsx(\"button\",{className:d===direction?'active':'',onClick:()=>setDirection(d),children:d},d)),/*#__PURE__*/_jsxs(\"label\",{className:\"toggle\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:hidePast,onChange:e=>setHidePast(e.target.checked)}),\" hide past\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"times-row\",children:futureTimes.map(t=>/*#__PURE__*/_jsx(\"span\",{className:t===nextTime?'next bus-chip':'bus-chip',children:t},t))}),/*#__PURE__*/_jsx(\"div\",{className:\"countdown\",children:countdown&&/*#__PURE__*/_jsxs(\"span\",{children:[\"Next: \",nextTime,\" (\",countdown,\")\"]})}),specialList.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"specials\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Specials\"}),/*#__PURE__*/_jsx(\"ul\",{children:specialList.map((s,i)=>/*#__PURE__*/_jsxs(\"li\",{children:[s.time,\" \",s.label]},i))})]})]});}","map":{"version":3,"names":["React","useState","useEffect","useMemo","jsx","_jsx","jsxs","_jsxs","parseTime","str","h","m","split","map","Number","formatCountdown","mins","Math","floor","concat","CampusBus","_ref","_data$categories","_data$categories$cat","data","categories","Object","keys","cat","setCat","direction","setDirection","hidePast","setHidePast","now","setNow","Date","id","setInterval","clearInterval","includes","minutesNow","getHours","getMinutes","times","futureTimes","filter","t","nextTime","find","countdown","specials","specialList","slice","sort","a","b","time","length","className","children","c","onClick","d","type","checked","onChange","e","target","s","i","label"],"sources":["/home/chakri/Documents/Projects/Website/src/components/CampusBus.js"],"sourcesContent":["import React, { useState, useEffect, useMemo } from 'react';\n\nfunction parseTime(str){\n\tconst [h,m] = str.split(':').map(Number);\n\treturn h*60 + m;\n}\nfunction formatCountdown(mins){\n\tif(mins<=0) return 'now';\n\tconst h = Math.floor(mins/60); const m = mins%60;\n\treturn h? `${h}h ${m}m` : `${m}m`;\n}\n\nexport default function CampusBus({ data }) {\n\tconst categories = Object.keys(data?.categories||{});\n\tconst [cat,setCat] = useState(categories[0]||'');\n\tconst [direction,setDirection] = useState('toCampus');\n\tconst [hidePast,setHidePast] = useState(true);\n\tconst [now,setNow] = useState(()=> new Date());\n\tuseEffect(()=>{ const id=setInterval(()=> setNow(new Date()), 60*1000); return ()=>clearInterval(id); },[]);\n\n\tuseEffect(()=>{ if(!categories.includes(cat) && categories[0]) setCat(categories[0]); },[categories,cat]);\n\n\tconst minutesNow = now.getHours()*60 + now.getMinutes();\n\n\tconst times = data?.categories?.[cat]?.[direction] || [];\n\tconst futureTimes = times.filter(t=> !hidePast || parseTime(t) >= minutesNow);\n\tconst nextTime = times.find(t=> parseTime(t) >= minutesNow);\n\tconst countdown = nextTime? formatCountdown(parseTime(nextTime)-minutesNow) : null;\n\n\tconst specials = data?.specials || [];\n\tconst specialList = useMemo(()=> specials.slice().sort((a,b)=> parseTime(a.time)-parseTime(b.time)),[specials]);\n\n\tif(!categories.length) return <div className=\"panel\"><p>No bus data.</p></div>;\n\n\treturn (\n\t\t<div className=\"panel\">\n\t\t\t<div className=\"panel-header\">\n\t\t\t\t<h3>Campus Buses</h3>\n\t\t\t\t<div className=\"segmented-inline\">\n\t\t\t\t\t{categories.map(c=> <button key={c} className={c===cat? 'active':''} onClick={()=>setCat(c)}>{c}</button>)}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div className=\"segmented-inline\">\n\t\t\t\t{['toCampus','fromCampus'].map(d=> <button key={d} className={d===direction? 'active':''} onClick={()=>setDirection(d)}>{d}</button>)}\n\t\t\t\t<label className=\"toggle\"><input type=\"checkbox\" checked={hidePast} onChange={e=>setHidePast(e.target.checked)} /> hide past</label>\n\t\t\t</div>\n\t\t\t<div className=\"times-row\">\n\t\t\t\t{futureTimes.map(t=> <span key={t} className={t===nextTime? 'next bus-chip':'bus-chip'}>{t}</span>)}\n\t\t\t</div>\n\t\t\t<div className=\"countdown\">{countdown && <span>Next: {nextTime} ({countdown})</span>}</div>\n\t\t\t{specialList.length>0 && <div className=\"specials\">\n\t\t\t\t<h4>Specials</h4>\n\t\t\t\t<ul>{specialList.map((s,i)=> <li key={i}>{s.time} {s.label}</li>)}</ul>\n\t\t\t</div>}\n\t\t</div>\n\t);\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}